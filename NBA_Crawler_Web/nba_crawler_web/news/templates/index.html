{% extends "base.html" %}

{% block content %}
    <div id=News>
    </div>
{% endblock %}

{% block javascript %}
<script>
    var news_list = [];
    $.ajax({
        url: '/NewsList/',
        type: 'get',
        success: function(data) {
            news_list = data;
            $("#News").html("<div id=NewsList></div>")
            $.each(news_list, function(i, item) {
                $("#NewsList").append(
                    "<p>" + 
                        "<button id=" + news_list[i].id + "> " + "Go </button>" + 
                        "<tr>" +
                            "<td>" + news_list[i].title + "</td>" +
                            "<td>" + news_list[i].datetime + "</td>" +
                        "</tr>" + 
                    "<p>");
            });
        },
        failure: function(data) { 
            console.log('Got an error dude');
        }
    });

    $(document).ready(function(){
        $("button").click(function(){
            url = '/NewsDetail/' + this.id + '/';
            $.get(url, function(data, status){
                $("#News").html("<div id=NewsDetail></div>")
                console.log(data);
                $("#NewsDetail").append(
                    "<article>" +
                        "<h1>" + data.title + "</h1>" +
                        '<img width="582" height="376" src="' + data.image_url + '">' +
                        "<p>" + data.datetime + data.author + "</p>" +
                        "<p>" + data.content.replace(/\n/g, "</br>") + "</p>" +
                        '<iframe width="600" height="450" src="' + data.video_url + '" controls="controls">' +
                            "your browser does not support the video tag" +
                        "</iframe>" +
                    "</article>");
            });
        });
    });
</script>
{% endblock %}